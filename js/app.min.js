function router(e,n){e.state("login",{url:"/login",controller:"LoginCtrl",templateUrl:"views/login.html",resolve:{isLogged:["Auth",function(e){return e.$waitForAuth()}]}}).state("register",{url:"/register",controller:"RegisterCtrl",templateUrl:"views/register.html",resolve:{usernames:["Usernames",function(e){return e.$loaded()}],isLogged:["Auth",function(e){return e.$waitForAuth()}]}}).state("messages",{controller:"MessagesCtrl",url:"/messages",templateUrl:"views/messages.html",resolve:{isLogged:["Auth",function(e){return e.$waitForAuth()}],channels:["Channels",function(e){return e.$loaded()}]}}).state("messages.user",{url:"/@:user",controller:"DirectCtrl",templateUrl:"views/chat.html",resolve:{usernames:["Usernames",function(e){return e.$loaded()}]}}).state("messages.channel",{url:"/:channel",controller:"ChannelCtrl",templateUrl:"views/chat.html"}),n.otherwise("/messages/general")}function interceptor(e){e.interceptors.push(["$q","$rootScope",function(e,n){function t(t){return console.error(t),n.errors.push(t.data),e.reject(t)}return n.errors=[],{requestError:t,responseError:t}}])}function ngAutoscroll(){function e(e,n){function t(){i&&(r.scrollTop=r.scrollHeight)}var r=n[0],i=!0,s="webkitfullscreenchange mozfullscreenchange fullscreenchange";n.on("DOMSubtreeModified",t),angular.element(document).on(s,t),n.on("scroll",function(){i=r.scrollTop==r.scrollHeight-r.offsetHeight}),e.$on("dividerTop",function(e,n){r.scrollTop=n})}return{link:e}}function ngFocus(){function e(e,n){n[0].focus()}return{link:e}}function divider(){function e(e,n){angular.element(document.getElementById("chat")).one("DOMSubtreeModified",function(){e.$emit("dividerTop",n[0].offsetTop-150)})}return{link:e}}function ngTabActive(e,n,t){function r(){angular.element(e).on("focus",function(){n.isTabActive=!0,n.$broadcast("tab-active",!0)}).on("blur",function(){n.isTabActive=!1,n.$broadcast("tab-active",!1)})}return{link:r}}function uniqueUsername(){function e(e,n,t,r){r.$validators.uniqueUsername=function(n){return!e.usernames.hasOwnProperty(n)}}return{require:"ngModel",link:e}}function ngEnter(){function e(e,n){n.on("input",function(){n.css("height",n[0].scrollHeight+2+"px")}),n.on("keydown",function(t){13!=t.keyCode||t.shiftKey||(e.ngEnter(),n.css("height","34px"),t.preventDefault())})}return{scope:{ngEnter:"&"},link:e}}function escape(){return function(e){return(e||"").replace(/</g,"&lt;")}}function code(){return function(e){return(e||"").replace(/```([^`]+)```/g,"<pre>$1</pre>").replace(/`([^`]+)`/g,"<code>$1</code>")}}function quote(){return function(e){return(e||"").replace(/^>([^\n]+)$\n?/gm,"<blockquote>$1</blockquote>")}}function link(e){var n=/(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})\/([\/\w\.\-=?]*)*\/?/gi,t=/\.(jpg|jpeg|png|gif)/,r=/(https?:\/\/)(www\.)?youtu\.?be(\.com)?\/(watch\?v=)?([\w\-_]+)(\?t=)?(\w+)?/i,i=/https?:\/\/vimeo\.com\/(\d+)/i;return function(s,a){return(s||"").replace(n,function(n,s){var o='<a href="'+(s?"":"http://")+n+'" target="_blank">'+n+"</a>";if(t.test(n)&&!a.image&&(a.image={src:n}),r.test(n)&&!a.youtube&&(a.youtube={id:n.match(r)[5]}),i.test(n)&&!a.vimeo){var c=n.match(i)[1];a.vimeo={id:c},e.jsonp("https://vimeo.com/api/v2/video/"+c+".json?callback=JSON_CALLBACK").success(function(e){a.vimeo.preview=e[0].thumbnail_large})}return o})}}function username(){return function(e,n){var t=n.users.map(function(e){return e.username});return(e||"").replace(/@(\w+)/,function(e,r){var i=n.user.username==r;return~t.indexOf(r)?(i&&n.$emmit("mention"),'<a href="#/messages/'+r+'"'+(i?'class="mention"':"")+">"+e+"</a>"):e})}}function channel(){return function(e,n){return(e||"").replace(/#(\w+)/gi,function(e,t){return n.channels.hasOwnProperty(t)?'<a href="#/messages/'+t+'">'+e+"</a>":e})}}function trustAsHtml(e){return e.trustAsHtml}function trustAsResourceUrl(e){return e.trustAsResourceUrl}function ChannelCtrl(e,n,t,r,i,s){return t.params.channel&&r.hasOwnProperty(t.params.channel)?(n.msg={},e.directWith=null,e.channel=t.params.channel,n.divider=n.user.lastReaded&&n.user.lastReaded[n.channel],s.set(n.channel),n.addMessage=function(){n.msgForm.$invalid||(n.msg.channel=n.channel,n.msg.timestamp=Firebase.ServerValue.TIMESTAMP,n.msg.author={id:n.user.$id,username:n.user.username,avatar:n.user.avatar},n.messages[n.channel].$add(n.msg),n.msg={})},n.remove=function(e){n.messages[n.channel].$remove(e)},n.$watchCollection("messages."+n.channel,function(e){n.user.lastReaded=n.user.lastReaded||{},n.user.lastReaded[n.channel]=e.length&&e[e.length-1].$id,n.user.$save()}),void n.$on("mention",function(){n.isTabActive||s.add("! ")})):t.go("messages.channel",{channel:"general"})}function DirectCtrl(e,n,t,r,i,s){return r.hasOwnProperty(t.params.user)?(e.msg={},n.channel=null,n.directWith={$id:r[t.params.user],username:t.params.user},e.messages=i.messages(e.user.$id,e.directWith.$id),s.set("@"+e.directWith.username),s.remove(),i.removeNotifications(e.user.$id,e.directWith.$id),e.addMessage=function(){e.msgForm.$invalid||(e.msg.timestamp=Firebase.ServerValue.TIMESTAMP,e.msg.author={id:e.user.$id,username:e.user.username,avatar:e.user.avatar},e.messages.$add(e.msg),i.notify(e.user.$id,e.directWith.$id),e.msg={})},e.remove=function(n){e.messages.$remove(n)},void e.$watchCollection("messages",function(){e.directNotify.$ref().child(e.directWith.$id).remove()})):console.log("user not found")}function LoginCtrl(e,n,t,r,i,s){return e.newUser={},s?t.go("messages.channel"):void(e.login=function(){n.isLoadingHidden=!1,r.$authWithPassword(e.newUser).then(function(e){i.setOnline(e.uid),t.go("messages.channel")})["catch"](console.error)})}function MainCtrl(e,n,t,r,i,s){n.isTabActive=!0,r.$onAuth(function(e){e?(n.user=i.getProfile(e.uid),i.setOnline(e.uid),n.isAdmin=i.isAdmin(e.uid)):(n.user=null,t.go("login"))}),e.lightbox=function(n){e.lightboxSrc=n},e.$on("$stateChangeSuccess",function(){n.isLoadingHidden=!0})}function MessagesCtrl(e,n,t,r,i,s,a,o,c,l){return c?(n.is("messages")&&n.go("messages.channel"),e.messages={},e.users=i.all,e.channels=l,e.directNotify=a.notifications(e.user.$id),e.createChannel=function(){e.newChannelForm.$invalid||(e.channels[e.newChannelName]=!0,e.channels.$save(),e.messages[e.newChannelName]=r(e.newChannelName),e.newChannelName="",e.isNewChannelFormShowed=!1)},e.logout=function(){i.setOffline(e.user.$id),t.$unauth()},e.channels.$ref().on("child_added",function(n){e.messages[n.key()]=r(n.key())}),angular.forEach(e.messages,function(n){n.$ref().on("child_added",function(){e.isTabActive||s.add("* ")})}),e.directNotify.$ref().on("child_added",function(e){s.add("! ")}),void e.$on("tab-active",function(e,n){n&&s.remove()})):n.go("login")}function RegisterCtrl(e,n,t,r,i,s,a){return e.usernames=s,e.newUser={},a?t.go("messages.channel"):void(e.register=function(){if(!e.RegisterForm.$invalid){if(e.usernames[e.newUser.username])return console.log("this username already exists");n.isLoadingHidden=!1,r.$createUser(e.newUser).then(function(n){return r.$authWithPassword(e.newUser)}).then(function(n){i.setOnline(n.uid);var r=i.getProfile(n.uid);e.usernames[e.newUser.username]=n.uid,e.usernames.$save(),r.username=e.newUser.username,r.avatar=n.password.profileImageURL,r.$save(),i.all.$save(),t.go("messages.channel")})}})}angular.module("FlameSlackApp",["ui.router","firebase","ngSanitize"]).constant("FB","https://flame-slack.firebaseio.com/").config(router).config(interceptor),router.$inject=["$stateProvider","$urlRouterProvider"],interceptor.$inject=["$httpProvider"],angular.module("FlameSlackApp").directive("ngAutoscroll",ngAutoscroll).directive("divider",divider).directive("ngTabActive",ngTabActive).directive("uniqueUsername",uniqueUsername).directive("ngEnter",ngEnter).directive("ngFocus",ngFocus),ngTabActive.$inject=["$window","$rootScope","Title"],angular.module("FlameSlackApp").factory("Auth",["$firebaseAuth","FB",function(e,n){return e(new Firebase(n))}]).factory("Users",["$firebaseArray","$firebaseObject","FB",function(e,n,t){var r=new Firebase(t+"users"),i=new Firebase(t+".info/connected"),s=e(r);return{getProfile:function(e){return n(r.child(e))},setOnline:function(t){var s=n(i);online=e(r.child(t+"/online")),s.$watch(function(){s.$value===!0&&online.$add(!0).then(function(){online.$ref().onDisconnect().remove()})}),r.child(t+"/lastOnline").onDisconnect().set(Firebase.ServerValue.TIMESTAMP)},setOffline:function(e){r.child(e+"/online").remove(),r.child(e+"/lastOnline").set(Firebase.ServerValue.TIMESTAMP)},isAdmin:function(e){return n(new Firebase(t).child("admins").child(e))},all:s}}]).factory("Usernames",["$firebaseObject","FB",function(e,n){return e(new Firebase(n+"usernames"))}]).factory("Channels",["$firebaseObject","FB",function(e,n){return e(new Firebase(n+"channels"))}]).factory("Messages",["$firebaseArray","FB",function(e,n){var t=new Firebase(n+"messages");return function(n){return e(t.child(n))}}]).factory("Direct",["$firebaseArray","$firebaseObject","FB",function(e,n,t){return{messages:function(n,r){var i=r>n?n+"/"+r:r+"/"+n;return e(new Firebase(t).child("direct").child(i))},notify:function(e,n){var r=new Firebase(t+"directNotification").child(n).child(e);r.transaction(function(e){return(e||0)+1})},notifications:function(e){return n(new Firebase(t+"directNotification").child(e))},removeNotifications:function(e,n){new Firebase(t+"directNotification").child(e).child(n).remove()}}}]).factory("Title",["$rootScope","FB",function(e,n){var t={set:function(n){e.title=n+" | Flame Slack"},add:function(n){~e.title.indexOf(n)||(e.title=n+e.title)},remove:function(n){n?~e.title.indexOf(n)&&(e.title=(e.title||"").replace(n,"")):e.title=(e.title||"").replace(/[\!\*] /g,"")}};return t}]),angular.module("FlameSlackApp").filter("escape",escape).filter("code",code).filter("quote",quote).filter("link",link).filter("username",username).filter("channel",channel).filter("trustAsHtml",trustAsHtml).filter("trustAsResourceUrl",trustAsResourceUrl),link.$inject=["$http"],trustAsHtml.$inject=["$sce"],trustAsResourceUrl.$inject=["$sce"],angular.module("FlameSlackApp").controller("ChannelCtrl",ChannelCtrl),ChannelCtrl.$inject=["$rootScope","$scope","$state","channels","Messages","Title"],angular.module("FlameSlackApp").controller("DirectCtrl",DirectCtrl),DirectCtrl.$inject=["$scope","$rootScope","$state","usernames","Direct","Title"],angular.module("FlameSlackApp").controller("LoginCtrl",LoginCtrl),LoginCtrl.$inject=["$scope","$rootScope","$state","Auth","Users","isLogged"],angular.module("FlameSlackApp").controller("MainCtrl",MainCtrl),MainCtrl.$inject=["$scope","$rootScope","$state","Auth","Users","Usernames"],angular.module("FlameSlackApp").controller("MessagesCtrl",MessagesCtrl),MessagesCtrl.$inject=["$scope","$state","Auth","Messages","Users","Title","Direct","FB","isLogged","channels"],angular.module("FlameSlackApp").controller("RegisterCtrl",RegisterCtrl),RegisterCtrl.$inject=["$scope","$rootScope","$state","Auth","Users","usernames","isLogged"];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImRpcmVjdGl2ZXMuanMiLCJmaWx0ZXJzLmpzIiwiY29udHJvbGxlcnMvY2hhbm5lbC5jdHJsLmpzIiwiY29udHJvbGxlcnMvZGlyZWN0LmN0cmwuanMiLCJjb250cm9sbGVycy9sb2dpbi5jdHJsLmpzIiwiY29udHJvbGxlcnMvbWFpbi5jdHJsLmpzIiwiY29udHJvbGxlcnMvbWVzc2FnZXMuY3RybC5qcyIsImNvbnRyb2xsZXJzL3JlZ2lzdGVyLmN0cmwuanMiLCJhcHAubWluLmpzIiwiZmFjdG9yaWVzLmpzIl0sIm5hbWVzIjpbInJvdXRlciIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwic3RhdGUiLCJ1cmwiLCJjb250cm9sbGVyIiwidGVtcGxhdGVVcmwiLCJyZXNvbHZlIiwiaXNMb2dnZWQiLCJBdXRoIiwiJHdhaXRGb3JBdXRoIiwidXNlcm5hbWVzIiwiVXNlcm5hbWVzIiwiJGxvYWRlZCIsImNoYW5uZWxzIiwiQ2hhbm5lbHMiLCJvdGhlcndpc2UiLCJpbnRlcmNlcHRvciIsIiRodHRwUHJvdmlkZXIiLCJpbnRlcmNlcHRvcnMiLCJwdXNoIiwiJHEiLCIkcm9vdFNjb3BlIiwib25FcnJvciIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImVycm9ycyIsImRhdGEiLCJyZWplY3QiLCJyZXF1ZXN0RXJyb3IiLCJyZXNwb25zZUVycm9yIiwibmdBdXRvc2Nyb2xsIiwibGluayIsIiRzY29wZSIsIiRlbCIsInNjcm9sbFRvQm90dG9tIiwiaXNTY3JvbGxlZCIsImVsIiwic2Nyb2xsVG9wIiwic2Nyb2xsSGVpZ2h0IiwiZnVsbHNjcmVlbmNoYW5nZSIsIm9uIiwiYW5ndWxhciIsImVsZW1lbnQiLCJkb2N1bWVudCIsIm9mZnNldEhlaWdodCIsIiRvbiIsImUiLCJ0b3AiLCJuZ0ZvY3VzIiwiZm9jdXMiLCJkaXZpZGVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJvbmUiLCIkZW1pdCIsIm9mZnNldFRvcCIsIm5nVGFiQWN0aXZlIiwiJHdpbmRvdyIsIlRpdGxlIiwiaXNUYWJBY3RpdmUiLCIkYnJvYWRjYXN0IiwidW5pcXVlVXNlcm5hbWUiLCIkYXR0cnMiLCJuZ01vZGVsIiwiJHZhbGlkYXRvcnMiLCJ2YWwiLCJoYXNPd25Qcm9wZXJ0eSIsInJlcXVpcmUiLCJuZ0VudGVyIiwiY3NzIiwia2V5Q29kZSIsInNoaWZ0S2V5IiwicHJldmVudERlZmF1bHQiLCJzY29wZSIsImVzY2FwZSIsInRleHQiLCJyZXBsYWNlIiwiY29kZSIsInF1b3RlIiwiJGh0dHAiLCJsaW5rUmVnRXhwIiwiaW1hZ2VSZWdFeHAiLCJ5b3V0dWJlUmVnRXhwIiwidmltZW9SZWdFeHAiLCJwcm90b2NvbCIsImh0bWwiLCJ0ZXN0IiwiaW1hZ2UiLCJzcmMiLCJ5b3V0dWJlIiwiaWQiLCJtYXRjaCIsInZpbWVvIiwidmltZW9JZCIsImpzb25wIiwic3VjY2VzcyIsInByZXZpZXciLCJ0aHVtYm5haWxfbGFyZ2UiLCJ1c2VybmFtZSIsInVzZXJzIiwibWFwIiwidXNlciIsImN1cnJlbnRVc2VyIiwiaW5kZXhPZiIsIiRlbW1pdCIsImNoYW5uZWwiLCJ0cnVzdEFzSHRtbCIsIiRzY2UiLCJ0cnVzdEFzUmVzb3VyY2VVcmwiLCJDaGFubmVsQ3RybCIsIiRzdGF0ZSIsIk1lc3NhZ2VzIiwicGFyYW1zIiwibXNnIiwiZGlyZWN0V2l0aCIsImxhc3RSZWFkZWQiLCJzZXQiLCJhZGRNZXNzYWdlIiwibXNnRm9ybSIsIiRpbnZhbGlkIiwidGltZXN0YW1wIiwiRmlyZWJhc2UiLCJTZXJ2ZXJWYWx1ZSIsIlRJTUVTVEFNUCIsImF1dGhvciIsIiRpZCIsImF2YXRhciIsIm1lc3NhZ2VzIiwiJGFkZCIsInJlbW92ZSIsIiRyZW1vdmUiLCIkd2F0Y2hDb2xsZWN0aW9uIiwibXNncyIsImxlbmd0aCIsIiRzYXZlIiwiYWRkIiwiZ28iLCJEaXJlY3RDdHJsIiwiRGlyZWN0IiwicmVtb3ZlTm90aWZpY2F0aW9ucyIsIm5vdGlmeSIsImRpcmVjdE5vdGlmeSIsIiRyZWYiLCJjaGlsZCIsImxvZyIsIkxvZ2luQ3RybCIsIlVzZXJzIiwibmV3VXNlciIsImxvZ2luIiwiaXNMb2FkaW5nSGlkZGVuIiwiJGF1dGhXaXRoUGFzc3dvcmQiLCJ0aGVuIiwiYXV0aERhdGEiLCJzZXRPbmxpbmUiLCJ1aWQiLCJNYWluQ3RybCIsIiRvbkF1dGgiLCJnZXRQcm9maWxlIiwiaXNBZG1pbiIsImxpZ2h0Ym94IiwibGlnaHRib3hTcmMiLCJNZXNzYWdlc0N0cmwiLCJGQiIsImlzIiwiYWxsIiwibm90aWZpY2F0aW9ucyIsImNyZWF0ZUNoYW5uZWwiLCJuZXdDaGFubmVsRm9ybSIsIm5ld0NoYW5uZWxOYW1lIiwiaXNOZXdDaGFubmVsRm9ybVNob3dlZCIsImxvZ291dCIsInNldE9mZmxpbmUiLCIkdW5hdXRoIiwic25hcCIsImtleSIsImZvckVhY2giLCJhY3RpdmUiLCJSZWdpc3RlckN0cmwiLCJyZWdpc3RlciIsIlJlZ2lzdGVyRm9ybSIsIiRjcmVhdGVVc2VyIiwicHJvZmlsZSIsInBhc3N3b3JkIiwicHJvZmlsZUltYWdlVVJMIiwibW9kdWxlIiwiY29uc3RhbnQiLCJjb25maWciLCIkaW5qZWN0IiwiZGlyZWN0aXZlIiwiZmFjdG9yeSIsIiRmaXJlYmFzZUF1dGgiLCIkZmlyZWJhc2VBcnJheSIsIiRmaXJlYmFzZU9iamVjdCIsInVzZXJzUmVmIiwiY29ubmVjdGVkUmVmIiwiY29ubmVjdGVkIiwib25saW5lIiwiJHdhdGNoIiwiJHZhbHVlIiwib25EaXNjb25uZWN0IiwibXNnUmVmIiwidWlkMSIsInVpZDIiLCJwYXRoIiwiZnJvbSIsInRvIiwicmVmIiwidHJhbnNhY3Rpb24iLCJ0aXRsZSIsInMiLCJmaWx0ZXIiXSwibWFwcGluZ3MiOiJBQVVBLFFBQVNBLFFBQU9DLEVBQWdCQyxHQUM5QkQsRUFDR0UsTUFBTSxTQUNMQyxJQUFLLFNBQ0xDLFdBQVksWUFDWkMsWUFBYSxtQkFDYkMsU0FDRUMsVUFBQSxPQUFVLFNBQVNDLEdBQ2pCLE1BQU9BLEdBQUtDLG9CQUlqQlAsTUFBTSxZQUNM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SUFBSXBJLFFBQVEsV0FBWSxLQU1wRSxPQUFPbEIsTVIvRlhoQixRQUFROEksT0FBTyxpQkFDWjBCLE9BQU8sU0FBVXhJLFFBQ2pCd0ksT0FBTyxPQUFRckksTUFDZnFJLE9BQU8sUUFBU3BJLE9BQ2hCb0ksT0FBTyxPQUFRbEwsTUFDZmtMLE9BQU8sV0FBWWhILFVBQ25CZ0gsT0FBTyxVQUFXekcsU0FDbEJ5RyxPQUFPLGNBQWV4RyxhQUN0QndHLE9BQU8scUJBQXNCdEcsb0JPaVdoQzVFLEtBQUsySixTQUFXLFNBb0NoQmpGLFlBQVlpRixTQUFXLFFBS3ZCL0UsbUJBQW1CK0UsU0FBVyxRTmxaOUJqSixRQUFROEksT0FBTyxpQkFDWnBMLFdBQVcsY0FBZXlHLGFNcWM3QkEsWUFBWThFLFNBQVcsYUFBYyxTQUFVLFNBQVUsV0FBWSxXQUFZLFNMdGNqRmpKLFFBQVE4SSxPQUFPLGlCQUNacEwsV0FBVyxhQUFjcUksWUtpZjVCQSxXQUFXa0QsU0FBVyxTQUFVLGFBQWMsU0FBVSxZQUFhLFNBQVUsU0psZi9FakosUUFBUThJLE9BQU8saUJBQ1pwTCxXQUFXLFlBQWE2SSxXSXNnQjNCQSxVQUFVMEMsU0FBVyxTQUFVLGFBQWMsU0FBVSxPQUFRLFFBQVMsWUh2Z0J4RWpKLFFBQVE4SSxPQUFPLGlCQUNacEwsV0FBVyxXQUFZdUosVUdraUIxQkEsU0FBU2dDLFNBQVcsU0FBVSxhQUFjLFNBQVUsT0FBUSxRQUFTLGFGbmlCdkVqSixRQUFROEksT0FBTyxpQkFDWnBMLFdBQVcsZUFBZ0I2SixjRXFsQjlCQSxhQUFhMEIsU0FBVyxTQUFVLFNBQVUsT0FBUSxXQUFZLFFBQVMsUUFBUyxTQUFVLEtBQU0sV0FBWSxZRHRsQjlHakosUUFBUThJLE9BQU8saUJBQ1pwTCxXQUFXLGVBQWdCNkssY0MwbkI5QkEsYUFBYVUsU0FBVyxTQUFVLGFBQWMsU0FBVSxPQUFRLFFBQVMsWUFBYSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ0ZsYW1lU2xhY2tBcHAnLCBbXHJcbiAgICAndWkucm91dGVyJywgXHJcbiAgICAnZmlyZWJhc2UnLCBcclxuICAgICduZ1Nhbml0aXplJyAgXHJcbiAgXSkgIFxyXG4gIC5jb25zdGFudCgnRkInLCAnaHR0cHM6Ly9mbGFtZS1zbGFjay5maXJlYmFzZWlvLmNvbS8nKVxyXG4gIC5jb25maWcocm91dGVyKVxyXG4gIC5jb25maWcoaW50ZXJjZXB0b3IpXHJcblxyXG5cclxuZnVuY3Rpb24gcm91dGVyKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcclxuICAkc3RhdGVQcm92aWRlclxyXG4gICAgLnN0YXRlKCdsb2dpbicsIHsgXHJcbiAgICAgIHVybDogJy9sb2dpbicsXHJcbiAgICAgIGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwnLFxyXG4gICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL2xvZ2luLmh0bWwnLFxyXG4gICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgaXNMb2dnZWQ6IGZ1bmN0aW9uKEF1dGgpIHtcclxuICAgICAgICAgIHJldHVybiBBdXRoLiR3YWl0Rm9yQXV0aCgpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgLnN0YXRlKCdyZWdpc3RlcicsIHtcclxuICAgICAgdXJsOiAnL3JlZ2lzdGVyJyxcclxuICAgICAgY29udHJvbGxlcjogJ1JlZ2lzdGVyQ3RybCcsXHJcbiAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvcmVnaXN0ZXIuaHRtbCcsXHJcbiAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICB1c2VybmFtZXM6IGZ1bmN0aW9uKFVzZXJuYW1lcykge1xyXG4gICAgICAgICAgcmV0dXJuIFVzZXJuYW1lcy4kbG9hZGVkKClcclxuICAgICAgICB9LFxyXG4gICAgICAgIGlzTG9nZ2VkOiBmdW5jdGlvbihBdXRoKSB7XHJcbiAgICAgICAgICByZXR1cm4gQXV0aC4kd2FpdEZvckF1dGgoKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIC5zdGF0ZSgnbWVzc2FnZXMnLCB7XHJcbiAgICAgIGNvbnRyb2xsZXI6ICdNZXNzYWdlc0N0cmwnLFxyXG4gICAgICB1cmw6ICcvbWVzc2FnZXMnLFxyXG4gICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL21lc3NhZ2VzLmh0bWwnLFxyXG4gICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgaXNMb2dnZWQ6IGZ1bmN0aW9uKEF1dGgpIHtcclxuICAgICAgICAgIHJldHVybiBBdXRoLiR3YWl0Rm9yQXV0aCgpXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjaGFubmVsczogZnVuY3Rpb24oQ2hhbm5lbHMpIHtcclxuICAgICAgICAgIHJldHVybiBDaGFubmVscy4kbG9hZGVkKClcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICAuc3RhdGUoJ21lc3NhZ2VzLnVzZXInLCB7XHJcbiAgICAgIHVybDogJy9AOnVzZXInLFxyXG4gICAgICBjb250cm9sbGVyOiAnRGlyZWN0Q3RybCcsXHJcbiAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvY2hhdC5odG1sJyxcclxuICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgIHVzZXJuYW1lczogZnVuY3Rpb24oVXNlcm5hbWVzKSB7IFxyXG4gICAgICAgICAgcmV0dXJuIFVzZXJuYW1lcy4kbG9hZGVkKClcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pIFxyXG4gICAgLnN0YXRlKCdtZXNzYWdlcy5jaGFubmVsJywge1xyXG4gICAgICB1cmw6ICcvOmNoYW5uZWwnLFxyXG4gICAgICBjb250cm9sbGVyOiAnQ2hhbm5lbEN0cmwnLFxyXG4gICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL2NoYXQuaHRtbCdcclxuICAgIH0pXHJcblxyXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZShcIi9tZXNzYWdlcy9nZW5lcmFsXCIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpbnRlcmNlcHRvcigkaHR0cFByb3ZpZGVyKSB7XHJcbiAgJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaChmdW5jdGlvbigkcSwgJHJvb3RTY29wZSkge1xyXG4gICAgJHJvb3RTY29wZS5lcnJvcnMgPSBbXVxyXG4gICAgXHJcbiAgICBmdW5jdGlvbiBvbkVycm9yKGVycikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycilcclxuICAgICAgJHJvb3RTY29wZS5lcnJvcnMucHVzaChlcnIuZGF0YSlcclxuICAgICAgcmV0dXJuICRxLnJlamVjdChlcnIpXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgcmVxdWVzdEVycm9yOiBvbkVycm9yLFxyXG4gICAgICByZXNwb25zZUVycm9yOiBvbkVycm9yXHJcbiAgICB9XHJcbiAgfSlcclxufSIsImFuZ3VsYXIubW9kdWxlKCdGbGFtZVNsYWNrQXBwJylcclxuICAuZGlyZWN0aXZlKCduZ0F1dG9zY3JvbGwnLCBuZ0F1dG9zY3JvbGwpXHJcbiAgLmRpcmVjdGl2ZSgnZGl2aWRlcicsIGRpdmlkZXIpXHJcbiAgLmRpcmVjdGl2ZSgnbmdUYWJBY3RpdmUnLCBuZ1RhYkFjdGl2ZSlcclxuICAuZGlyZWN0aXZlKCd1bmlxdWVVc2VybmFtZScsIHVuaXF1ZVVzZXJuYW1lKVxyXG4gIC5kaXJlY3RpdmUoJ25nRW50ZXInLCBuZ0VudGVyKVxyXG4gIC5kaXJlY3RpdmUoJ25nRm9jdXMnLCBuZ0ZvY3VzKVxyXG5cclxuXHJcbmZ1bmN0aW9uIG5nQXV0b3Njcm9sbCgpIHtcclxuICBmdW5jdGlvbiBsaW5rKCRzY29wZSwgJGVsKSB7XHJcbiAgICB2YXIgZWwgPSAkZWxbMF0sXHJcbiAgICAgICAgaXNTY3JvbGxlZCA9IHRydWUsXHJcbiAgICAgICAgZnVsbHNjcmVlbmNoYW5nZSA9ICd3ZWJraXRmdWxsc2NyZWVuY2hhbmdlIG1vemZ1bGxzY3JlZW5jaGFuZ2UgZnVsbHNjcmVlbmNoYW5nZSdcclxuXHJcbiAgICBmdW5jdGlvbiBzY3JvbGxUb0JvdHRvbSgpIHtcclxuICAgICAgaWYgKGlzU2Nyb2xsZWQpIGVsLnNjcm9sbFRvcCA9IGVsLnNjcm9sbEhlaWdodFxyXG4gICAgfVxyXG5cclxuICAgICRlbC5vbignRE9NU3VidHJlZU1vZGlmaWVkJywgc2Nyb2xsVG9Cb3R0b20pXHJcblxyXG4gICAgLy8gY2hyb21lIHNjcm9sbCBmaXhcclxuICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudCkub24oZnVsbHNjcmVlbmNoYW5nZSwgc2Nyb2xsVG9Cb3R0b20pXHJcblxyXG4gICAgJGVsLm9uKCdzY3JvbGwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgaXNTY3JvbGxlZCA9IGVsLnNjcm9sbFRvcCA9PSBlbC5zY3JvbGxIZWlnaHQgLSBlbC5vZmZzZXRIZWlnaHRcclxuICAgIH0pXHJcblxyXG4gICAgJHNjb3BlLiRvbignZGl2aWRlclRvcCcsIGZ1bmN0aW9uKGUsIHRvcCkge1xyXG4gICAgICBlbC5zY3JvbGxUb3AgPSB0b3BcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgbGluazogbGlua1xyXG4gIH1cclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIG5nRm9jdXMoKSB7XHJcbiAgZnVuY3Rpb24gbGluaygkc2NvcGUsICRlbCkge1xyXG4gICAgJGVsWzBdLmZvY3VzKClcclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBsaW5rOiBsaW5rXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBkaXZpZGVyKCkge1xyXG4gIGZ1bmN0aW9uIGxpbmsoJHNjb3BlLCAkZWwpIHtcclxuICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hhdCcpKVxyXG4gICAgICAub25lKCdET01TdWJ0cmVlTW9kaWZpZWQnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkc2NvcGUuJGVtaXQoJ2RpdmlkZXJUb3AnLCAkZWxbMF0ub2Zmc2V0VG9wIC0gMTUwKVxyXG4gICAgICB9KVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGxpbms6IGxpbmtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG5nVGFiQWN0aXZlKCR3aW5kb3csICRyb290U2NvcGUsICBUaXRsZSkge1xyXG4gIGZ1bmN0aW9uIGxpbmsoKSB7XHJcbiAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdylcclxuICAgICAgLm9uKCdmb2N1cycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICRyb290U2NvcGUuaXNUYWJBY3RpdmUgPSB0cnVlXHJcbiAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd0YWItYWN0aXZlJywgdHJ1ZSlcclxuICAgICAgfSlcclxuICAgICAgLm9uKCdibHVyJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJHJvb3RTY29wZS5pc1RhYkFjdGl2ZSA9IGZhbHNlXHJcbiAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd0YWItYWN0aXZlJywgZmFsc2UpXHJcbiAgICAgIH0pXHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgbGluazogbGlua1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gdW5pcXVlVXNlcm5hbWUoKSB7XHJcbiAgZnVuY3Rpb24gbGluaygkc2NvcGUsICRlbCwgJGF0dHJzLCBuZ01vZGVsKSB7XHJcbiAgICBuZ01vZGVsLiR2YWxpZGF0b3JzLnVuaXF1ZVVzZXJuYW1lID0gZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgIHJldHVybiAhJHNjb3BlLnVzZXJuYW1lcy5oYXNPd25Qcm9wZXJ0eSh2YWwpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgcmVxdWlyZTogJ25nTW9kZWwnLFxyXG4gICAgbGluazogbGlua1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gbmdFbnRlcigpIHtcclxuICBmdW5jdGlvbiBsaW5rKCRzY29wZSwgJGVsKSB7XHJcbiAgICAkZWwub24oJ2lucHV0JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICRlbC5jc3MoJ2hlaWdodCcsICRlbFswXS5zY3JvbGxIZWlnaHQgKyAyICsgJ3B4JylcclxuICAgIH0pXHJcblxyXG4gICAgJGVsLm9uKCdrZXlkb3duJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBpZiAoZS5rZXlDb2RlID09IDEzICYmICFlLnNoaWZ0S2V5KSB7XHJcbiAgICAgICAgJHNjb3BlLm5nRW50ZXIoKVxyXG4gICAgICAgICRlbC5jc3MoJ2hlaWdodCcsICczNHB4JylcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBzY29wZToge1xyXG4gICAgICBuZ0VudGVyOiAnJidcclxuICAgIH0sXHJcbiAgICBsaW5rOiBsaW5rXHJcbiAgfVxyXG59IiwiYW5ndWxhci5tb2R1bGUoJ0ZsYW1lU2xhY2tBcHAnKVxyXG4gIC5maWx0ZXIoJ2VzY2FwZScsIGVzY2FwZSlcclxuICAuZmlsdGVyKCdjb2RlJywgY29kZSlcclxuICAuZmlsdGVyKCdxdW90ZScsIHF1b3RlKVxyXG4gIC5maWx0ZXIoJ2xpbmsnLCBsaW5rKVxyXG4gIC5maWx0ZXIoJ3VzZXJuYW1lJywgdXNlcm5hbWUpXHJcbiAgLmZpbHRlcignY2hhbm5lbCcsIGNoYW5uZWwpXHJcbiAgLmZpbHRlcigndHJ1c3RBc0h0bWwnLCB0cnVzdEFzSHRtbClcclxuICAuZmlsdGVyKCd0cnVzdEFzUmVzb3VyY2VVcmwnLCB0cnVzdEFzUmVzb3VyY2VVcmwpXHJcblxyXG5cclxuZnVuY3Rpb24gZXNjYXBlKCkge1xyXG4gIHJldHVybiBmdW5jdGlvbih0ZXh0KSB7XHJcbiAgICByZXR1cm4gKHRleHR8fCcnKS5yZXBsYWNlKC88L2csICcmbHQ7JylcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNvZGUoKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKHRleHQpIHtcclxuICAgIHJldHVybiAodGV4dHx8JycpLnJlcGxhY2UoL2BgYChbXmBdKylgYGAvZywgJzxwcmU+JDE8L3ByZT4nKVxyXG4gICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvYChbXmBdKylgL2csICc8Y29kZT4kMTwvY29kZT4nKVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcXVvdGUoKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKHRleHQpIHtcclxuICAgIHJldHVybiAodGV4dHx8JycpLnJlcGxhY2UoL14+KFteXFxuXSspJFxcbj8vZ20sICc8YmxvY2txdW90ZT4kMTwvYmxvY2txdW90ZT4nKVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gbGluaygkaHR0cCkge1xyXG4gIHZhciBsaW5rUmVnRXhwID0gLyhodHRwcz86XFwvXFwvKT8oW1xcZGEtelxcLi1dKylcXC4oW2EtelxcLl17Miw2fSlcXC8oW1xcL1xcd1xcLlxcLT0/XSopKlxcLz8vZ2lcclxuICB2YXIgaW1hZ2VSZWdFeHAgPSAvXFwuKGpwZ3xqcGVnfHBuZ3xnaWYpL1xyXG4gIHZhciB5b3V0dWJlUmVnRXhwID0gLyhodHRwcz86XFwvXFwvKSh3d3dcXC4pP3lvdXR1XFwuP2JlKFxcLmNvbSk/XFwvKHdhdGNoXFw/dj0pPyhbXFx3XFwtX10rKShcXD90PSk/KFxcdyspPy9pXHJcbiAgdmFyIHZpbWVvUmVnRXhwID0gL2h0dHBzPzpcXC9cXC92aW1lb1xcLmNvbVxcLyhcXGQrKS9pXHJcblxyXG5cclxuICByZXR1cm4gZnVuY3Rpb24odGV4dCwgc2NvcGUpIHtcclxuICAgIHJldHVybiAodGV4dHx8JycpLnJlcGxhY2UobGlua1JlZ0V4cCwgZnVuY3Rpb24obGluaywgcHJvdG9jb2wpIHtcclxuICAgICAgdmFyIGh0bWwgPSAnPGEgaHJlZj1cIicgKyAocHJvdG9jb2wgPyAnJyA6ICdodHRwOi8vJykgKyBcclxuICAgICAgICAgICAgICAgICAgbGluayArICdcIiB0YXJnZXQ9XCJfYmxhbmtcIj4nICsgbGluayArICc8L2E+J1xyXG5cclxuICAgICAgaWYgKGltYWdlUmVnRXhwLnRlc3QobGluaykgJiYgIXNjb3BlLmltYWdlKSBcclxuICAgICAgICBzY29wZS5pbWFnZSA9IHsgc3JjOiBsaW5rIH1cclxuXHJcbiAgICAgIGlmICh5b3V0dWJlUmVnRXhwLnRlc3QobGluaykgJiYgIXNjb3BlLnlvdXR1YmUpIFxyXG4gICAgICAgIHNjb3BlLnlvdXR1YmUgPSB7IGlkOiBsaW5rLm1hdGNoKHlvdXR1YmVSZWdFeHApWzVdIH1cclxuXHJcbiAgICAgIGlmICh2aW1lb1JlZ0V4cC50ZXN0KGxpbmspICYmICFzY29wZS52aW1lbykge1xyXG4gICAgICAgIHZhciB2aW1lb0lkID0gbGluay5tYXRjaCh2aW1lb1JlZ0V4cClbMV1cclxuICAgICAgICBzY29wZS52aW1lbyA9IHsgaWQ6IHZpbWVvSWQgfVxyXG5cclxuICAgICAgICAkaHR0cC5qc29ucCgnaHR0cHM6Ly92aW1lby5jb20vYXBpL3YyL3ZpZGVvLycgKyB2aW1lb0lkICtcclxuICAgICAgICAgICAgICAgICAgICcuanNvbj9jYWxsYmFjaz1KU09OX0NBTExCQUNLJylcclxuICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2NvcGUudmltZW8ucHJldmlldyA9IGRhdGFbMF0udGh1bWJuYWlsX2xhcmdlXHJcbiAgICAgICAgICB9KVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gaHRtbFxyXG4gICAgfSlcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVzZXJuYW1lKCkgeyBcclxuICByZXR1cm4gZnVuY3Rpb24odGV4dCwgc2NvcGUpIHtcclxuICAgIHZhciB1c2VycyA9IHNjb3BlLnVzZXJzLm1hcChmdW5jdGlvbih1c2VyKSB7cmV0dXJuIHVzZXIudXNlcm5hbWV9KVxyXG5cclxuICAgIHJldHVybiAodGV4dHx8JycpLnJlcGxhY2UoL0AoXFx3KykvLCBmdW5jdGlvbihtYXRjaCwgdXNlcm5hbWUpIHtcclxuICAgICAgdmFyIGN1cnJlbnRVc2VyID0gc2NvcGUudXNlci51c2VybmFtZSA9PSB1c2VybmFtZVxyXG5cclxuICAgICAgaWYgKH51c2Vycy5pbmRleE9mKHVzZXJuYW1lKSkge1xyXG4gICAgICAgIGlmIChjdXJyZW50VXNlcikgc2NvcGUuJGVtbWl0KCdtZW50aW9uJylcclxuXHJcbiAgICAgICAgcmV0dXJuICc8YSBocmVmPVwiIy9tZXNzYWdlcy8nICsgdXNlcm5hbWUgKyAnXCInICtcclxuICAgICAgICAgICAgICAgKGN1cnJlbnRVc2VyID8gJ2NsYXNzPVwibWVudGlvblwiJyA6ICcnKSArXHJcbiAgICAgICAgICAgICAgICc+JyArIG1hdGNoICsgJzwvYT4nXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIG1hdGNoXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjaGFubmVsKCkge1xyXG4gIHJldHVybiBmdW5jdGlvbih0ZXh0LCBzY29wZSkge1xyXG4gICAgcmV0dXJuICh0ZXh0fHwnJykucmVwbGFjZSgvIyhcXHcrKS9naSwgZnVuY3Rpb24obWF0Y2gsIGNoYW5uZWwpIHtcclxuICAgICAgaWYgKHNjb3BlLmNoYW5uZWxzLmhhc093blByb3BlcnR5KGNoYW5uZWwpKVxyXG4gICAgICAgIHJldHVybiAnPGEgaHJlZj1cIiMvbWVzc2FnZXMvJyArIGNoYW5uZWwgKyAnXCI+JyArIG1hdGNoICsgJzwvYT4nXHJcbiAgICAgIGVsc2VcclxuICAgICAgICByZXR1cm4gbWF0Y2hcclxuICAgIH0pXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiB0cnVzdEFzSHRtbCgkc2NlKXtcclxuICByZXR1cm4gJHNjZS50cnVzdEFzSHRtbFxyXG59XHJcblxyXG5mdW5jdGlvbiB0cnVzdEFzUmVzb3VyY2VVcmwoJHNjZSkge1xyXG4gIHJldHVybiAkc2NlLnRydXN0QXNSZXNvdXJjZVVybFxyXG59XHJcblxyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoJ0ZsYW1lU2xhY2tBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdDaGFubmVsQ3RybCcsIENoYW5uZWxDdHJsKSAgXHJcblxyXG5cclxuZnVuY3Rpb24gQ2hhbm5lbEN0cmwoJHJvb3RTY29wZSwgJHNjb3BlLCAkc3RhdGUsIGNoYW5uZWxzLCBNZXNzYWdlcywgVGl0bGUpIHtcclxuICBpZiAoISRzdGF0ZS5wYXJhbXMuY2hhbm5lbCB8fCAhY2hhbm5lbHMuaGFzT3duUHJvcGVydHkoJHN0YXRlLnBhcmFtcy5jaGFubmVsKSlcclxuICAgIHJldHVybiAkc3RhdGUuZ28oJ21lc3NhZ2VzLmNoYW5uZWwnLCB7IGNoYW5uZWw6ICdnZW5lcmFsJyB9KSBcclxuICBcclxuICAkc2NvcGUubXNnID0ge31cclxuICAkcm9vdFNjb3BlLmRpcmVjdFdpdGggPSBudWxsXHJcbiAgJHJvb3RTY29wZS5jaGFubmVsID0gJHN0YXRlLnBhcmFtcy5jaGFubmVsXHJcbiAgJHNjb3BlLmRpdmlkZXIgPSAkc2NvcGUudXNlci5sYXN0UmVhZGVkICYmIFxyXG4gICAgICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIubGFzdFJlYWRlZFskc2NvcGUuY2hhbm5lbF1cclxuICBcclxuICBUaXRsZS5zZXQoJHNjb3BlLmNoYW5uZWwpXHJcblxyXG4gICRzY29wZS5hZGRNZXNzYWdlID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoJHNjb3BlLm1zZ0Zvcm0uJGludmFsaWQpIHJldHVybiBcclxuXHJcbiAgICAkc2NvcGUubXNnLmNoYW5uZWwgPSAkc2NvcGUuY2hhbm5lbFxyXG4gICAgJHNjb3BlLm1zZy50aW1lc3RhbXAgPSBGaXJlYmFzZS5TZXJ2ZXJWYWx1ZS5USU1FU1RBTVBcclxuICAgICRzY29wZS5tc2cuYXV0aG9yID0ge1xyXG4gICAgICBpZDogJHNjb3BlLnVzZXIuJGlkLFxyXG4gICAgICB1c2VybmFtZTogJHNjb3BlLnVzZXIudXNlcm5hbWUsXHJcbiAgICAgIGF2YXRhcjogJHNjb3BlLnVzZXIuYXZhdGFyXHJcbiAgICB9XHJcblxyXG4gICAgJHNjb3BlLm1lc3NhZ2VzWyRzY29wZS5jaGFubmVsXS4kYWRkKCRzY29wZS5tc2cpXHJcbiAgICAkc2NvcGUubXNnID0ge31cclxuICB9XHJcblxyXG4gICRzY29wZS5yZW1vdmUgPSBmdW5jdGlvbihtc2cpIHtcclxuICAgICRzY29wZS5tZXNzYWdlc1skc2NvcGUuY2hhbm5lbF0uJHJlbW92ZShtc2cpXHJcbiAgfVxyXG5cclxuICAvLyBsYXN0IHJlYWRlZCBtZXNzYWdlc1xyXG4gICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCdtZXNzYWdlcy4nICsgJHNjb3BlLmNoYW5uZWwsIGZ1bmN0aW9uKG1zZ3MpIHtcclxuICAgICRzY29wZS51c2VyLmxhc3RSZWFkZWQgPSAkc2NvcGUudXNlci5sYXN0UmVhZGVkIHx8IHt9XHJcbiAgICAkc2NvcGUudXNlci5sYXN0UmVhZGVkWyRzY29wZS5jaGFubmVsXSA9IG1zZ3MubGVuZ3RoICYmIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2dzW21zZ3MubGVuZ3RoLTFdLiRpZFxyXG4gICAgJHNjb3BlLnVzZXIuJHNhdmUoKVxyXG4gIH0pXHJcblxyXG4gIC8vIG1lbnRpb25cclxuICAkc2NvcGUuJG9uKCdtZW50aW9uJywgZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoISRzY29wZS5pc1RhYkFjdGl2ZSkgVGl0bGUuYWRkKCchICcpXHJcbiAgfSlcclxufSIsImFuZ3VsYXIubW9kdWxlKCdGbGFtZVNsYWNrQXBwJylcclxuICAuY29udHJvbGxlcignRGlyZWN0Q3RybCcsIERpcmVjdEN0cmwpXHJcblxyXG5cclxuZnVuY3Rpb24gRGlyZWN0Q3RybCgkc2NvcGUsICRyb290U2NvcGUsICRzdGF0ZSwgdXNlcm5hbWVzLCBEaXJlY3QsIFRpdGxlKSB7XHJcbiAgaWYgKCF1c2VybmFtZXMuaGFzT3duUHJvcGVydHkoJHN0YXRlLnBhcmFtcy51c2VyKSlcclxuICAgIHJldHVybiBjb25zb2xlLmxvZygndXNlciBub3QgZm91bmQnKVxyXG5cclxuICAkc2NvcGUubXNnID0ge31cclxuICAkcm9vdFNjb3BlLmNoYW5uZWwgPSBudWxsXHJcbiAgJHJvb3RTY29wZS5kaXJlY3RXaXRoID0ge1xyXG4gICAgJGlkOiB1c2VybmFtZXNbJHN0YXRlLnBhcmFtcy51c2VyXSxcclxuICAgIHVzZXJuYW1lOiAkc3RhdGUucGFyYW1zLnVzZXJcclxuICB9XHJcbiAgJHNjb3BlLm1lc3NhZ2VzID0gRGlyZWN0Lm1lc3NhZ2VzKCRzY29wZS51c2VyLiRpZCwgJHNjb3BlLmRpcmVjdFdpdGguJGlkKVxyXG5cclxuICBUaXRsZS5zZXQoJ0AnICsgJHNjb3BlLmRpcmVjdFdpdGgudXNlcm5hbWUpXHJcbiAgVGl0bGUucmVtb3ZlKClcclxuICBEaXJlY3QucmVtb3ZlTm90aWZpY2F0aW9ucygkc2NvcGUudXNlci4kaWQsICRzY29wZS5kaXJlY3RXaXRoLiRpZClcclxuXHJcbiAgJHNjb3BlLmFkZE1lc3NhZ2UgPSBmdW5jdGlvbigpIHtcclxuICAgIGlmICgkc2NvcGUubXNnRm9ybS4kaW52YWxpZCkgcmV0dXJuIFxyXG5cclxuICAgICRzY29wZS5tc2cudGltZXN0YW1wID0gRmlyZWJhc2UuU2VydmVyVmFsdWUuVElNRVNUQU1QXHJcbiAgICAkc2NvcGUubXNnLmF1dGhvciA9IHtcclxuICAgICAgaWQ6ICRzY29wZS51c2VyLiRpZCxcclxuICAgICAgdXNlcm5hbWU6ICRzY29wZS51c2VyLnVzZXJuYW1lLFxyXG4gICAgICBhdmF0YXI6ICRzY29wZS51c2VyLmF2YXRhclxyXG4gICAgfVxyXG5cclxuICAgICRzY29wZS5tZXNzYWdlcy4kYWRkKCRzY29wZS5tc2cpXHJcbiAgICBEaXJlY3Qubm90aWZ5KCRzY29wZS51c2VyLiRpZCwgJHNjb3BlLmRpcmVjdFdpdGguJGlkKVxyXG4gICAgJHNjb3BlLm1zZyA9IHt9XHJcbiAgfVxyXG5cclxuICAkc2NvcGUucmVtb3ZlID0gZnVuY3Rpb24obXNnKSB7XHJcbiAgICAkc2NvcGUubWVzc2FnZXMuJHJlbW92ZShtc2cpXHJcbiAgfVxyXG5cclxuICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbignbWVzc2FnZXMnLCBmdW5jdGlvbigpIHtcclxuICAgICRzY29wZS5kaXJlY3ROb3RpZnkuJHJlZigpLmNoaWxkKCRzY29wZS5kaXJlY3RXaXRoLiRpZCkucmVtb3ZlKClcclxuICB9KVxyXG59IiwiYW5ndWxhci5tb2R1bGUoJ0ZsYW1lU2xhY2tBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBMb2dpbkN0cmwpXHJcblxyXG5cclxuZnVuY3Rpb24gTG9naW5DdHJsKCRzY29wZSwgJHJvb3RTY29wZSwgJHN0YXRlLCBBdXRoLCBVc2VycywgaXNMb2dnZWQpIHtcclxuICAkc2NvcGUubmV3VXNlciA9IHt9XHJcblxyXG4gIGlmIChpc0xvZ2dlZCkgcmV0dXJuICRzdGF0ZS5nbygnbWVzc2FnZXMuY2hhbm5lbCcpXHJcblxyXG4gICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgJHJvb3RTY29wZS5pc0xvYWRpbmdIaWRkZW4gPSBmYWxzZVxyXG5cclxuICAgIEF1dGguJGF1dGhXaXRoUGFzc3dvcmQoJHNjb3BlLm5ld1VzZXIpXHJcbiAgICAgIC50aGVuKGZ1bmN0aW9uKGF1dGhEYXRhKSB7XHJcbiAgICAgICAgVXNlcnMuc2V0T25saW5lKGF1dGhEYXRhLnVpZClcclxuICAgICAgICAkc3RhdGUuZ28oJ21lc3NhZ2VzLmNoYW5uZWwnKVxyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICB9XHJcbn1cclxuIiwiYW5ndWxhci5tb2R1bGUoJ0ZsYW1lU2xhY2tBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdNYWluQ3RybCcsIE1haW5DdHJsKVxyXG5cclxuXHJcbmZ1bmN0aW9uIE1haW5DdHJsKCRzY29wZSwgJHJvb3RTY29wZSwgJHN0YXRlLCBBdXRoLCBVc2VycywgVXNlcm5hbWVzKSB7XHJcbiAgJHJvb3RTY29wZS5pc1RhYkFjdGl2ZSA9IHRydWVcclxuICBcclxuICBBdXRoLiRvbkF1dGgoZnVuY3Rpb24oYXV0aERhdGEpIHtcclxuICAgIGlmIChhdXRoRGF0YSkge1xyXG4gICAgICAkcm9vdFNjb3BlLnVzZXIgPSBVc2Vycy5nZXRQcm9maWxlKGF1dGhEYXRhLnVpZClcclxuICAgICAgVXNlcnMuc2V0T25saW5lKGF1dGhEYXRhLnVpZClcclxuICAgICAgJHJvb3RTY29wZS5pc0FkbWluID0gVXNlcnMuaXNBZG1pbihhdXRoRGF0YS51aWQpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAkcm9vdFNjb3BlLnVzZXIgPSBudWxsXHJcbiAgICAgICRzdGF0ZS5nbygnbG9naW4nKVxyXG4gICAgfVxyXG4gIH0pIFxyXG5cclxuICAkc2NvcGUubGlnaHRib3ggPSBmdW5jdGlvbihzcmMpIHtcclxuICAgICRzY29wZS5saWdodGJveFNyYyA9IHNyY1xyXG4gIH0gICAgICAgXHJcblxyXG4gICRzY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbigpIHtcclxuICAgICRyb290U2NvcGUuaXNMb2FkaW5nSGlkZGVuID0gdHJ1ZVxyXG4gIH0pIFxyXG59IiwiYW5ndWxhci5tb2R1bGUoJ0ZsYW1lU2xhY2tBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdNZXNzYWdlc0N0cmwnLCBNZXNzYWdlc0N0cmwpICBcclxuIFxyXG4gXHJcbmZ1bmN0aW9uIE1lc3NhZ2VzQ3RybCgkc2NvcGUsICRzdGF0ZSwgQXV0aCwgTWVzc2FnZXMsIFVzZXJzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgVGl0bGUsIERpcmVjdCwgRkIsaXNMb2dnZWQsIGNoYW5uZWxzKSB7XHJcblxyXG4gIGlmICghaXNMb2dnZWQpIHJldHVybiAkc3RhdGUuZ28oJ2xvZ2luJylcclxuICBpZiAoJHN0YXRlLmlzKCdtZXNzYWdlcycpKSAkc3RhdGUuZ28oJ21lc3NhZ2VzLmNoYW5uZWwnKVxyXG5cclxuICAkc2NvcGUubWVzc2FnZXMgPSB7fVxyXG4gICRzY29wZS51c2VycyA9IFVzZXJzLmFsbFxyXG4gICRzY29wZS5jaGFubmVscyA9IGNoYW5uZWxzXHJcbiAgJHNjb3BlLmRpcmVjdE5vdGlmeSA9IERpcmVjdC5ub3RpZmljYXRpb25zKCRzY29wZS51c2VyLiRpZCkgICAgXHJcblxyXG4gICRzY29wZS5jcmVhdGVDaGFubmVsID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoJHNjb3BlLm5ld0NoYW5uZWxGb3JtLiRpbnZhbGlkKSByZXR1cm5cclxuICAgICAgXHJcbiAgICAkc2NvcGUuY2hhbm5lbHNbJHNjb3BlLm5ld0NoYW5uZWxOYW1lXSA9IHRydWVcclxuICAgICRzY29wZS5jaGFubmVscy4kc2F2ZSgpXHJcbiAgICAkc2NvcGUubWVzc2FnZXNbJHNjb3BlLm5ld0NoYW5uZWxOYW1lXSA9IE1lc3NhZ2VzKCRzY29wZS5uZXdDaGFubmVsTmFtZSlcclxuICAgICRzY29wZS5uZXdDaGFubmVsTmFtZSA9ICcnXHJcbiAgICAkc2NvcGUuaXNOZXdDaGFubmVsRm9ybVNob3dlZCA9IGZhbHNlXHJcbiAgfVxyXG5cclxuICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICBVc2Vycy5zZXRPZmZsaW5lKCRzY29wZS51c2VyLiRpZClcclxuICAgIEF1dGguJHVuYXV0aCgpXHJcbiAgfSAgIFxyXG5cclxuICAvLyBsb2FkIG1lc3NhZ2VzIGZvciBuZXcgY2hhbm5lbFxyXG4gICRzY29wZS5jaGFubmVscy4kcmVmKCkub24oJ2NoaWxkX2FkZGVkJywgZnVuY3Rpb24oc25hcCkge1xyXG4gICAgJHNjb3BlLm1lc3NhZ2VzW3NuYXAua2V5KCldID0gTWVzc2FnZXMoc25hcC5rZXkoKSlcclxuICB9KSBcclxuXHJcbiAgLy8gbmV3IG1lc3NhZ2Ugbm90aWZpY2F0aW9uXHJcbiAgYW5ndWxhci5mb3JFYWNoKCRzY29wZS5tZXNzYWdlcywgZnVuY3Rpb24oY2hhbm5lbCkge1xyXG4gICAgY2hhbm5lbC4kcmVmKCkub24oJ2NoaWxkX2FkZGVkJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmICghJHNjb3BlLmlzVGFiQWN0aXZlKSBUaXRsZS5hZGQoJyogJylcclxuICAgIH0pXHJcbiAgfSlcclxuXHJcbiAgJHNjb3BlLmRpcmVjdE5vdGlmeS4kcmVmKCkub24oJ2NoaWxkX2FkZGVkJywgZnVuY3Rpb24oc25hcCkge1xyXG4gICAgVGl0bGUuYWRkKCchICcpXHJcbiAgfSlcclxuXHJcbiAgJHNjb3BlLiRvbigndGFiLWFjdGl2ZScsIGZ1bmN0aW9uKGUsIGFjdGl2ZSkge1xyXG4gICAgaWYgKGFjdGl2ZSkgVGl0bGUucmVtb3ZlKClcclxuICB9KSBcclxufSIsImFuZ3VsYXIubW9kdWxlKCdGbGFtZVNsYWNrQXBwJylcclxuICAuY29udHJvbGxlcignUmVnaXN0ZXJDdHJsJywgUmVnaXN0ZXJDdHJsKVxyXG5cclxuXHJcbmZ1bmN0aW9uIFJlZ2lzdGVyQ3RybCgkc2NvcGUsICRyb290U2NvcGUsICRzdGF0ZSwgQXV0aCwgVXNlcnMsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWVzLCBpc0xvZ2dlZCkge1xyXG4gICRzY29wZS51c2VybmFtZXMgPSB1c2VybmFtZXNcclxuICAkc2NvcGUubmV3VXNlciA9IHt9XHJcbiAgXHJcbiAgaWYgKGlzTG9nZ2VkKSByZXR1cm4gJHN0YXRlLmdvKCdtZXNzYWdlcy5jaGFubmVsJylcclxuXHJcbiAgJHNjb3BlLnJlZ2lzdGVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoJHNjb3BlLlJlZ2lzdGVyRm9ybS4kaW52YWxpZCkgcmV0dXJuXHJcbiAgICBpZiAoJHNjb3BlLnVzZXJuYW1lc1skc2NvcGUubmV3VXNlci51c2VybmFtZV0pXHJcbiAgICAgIHJldHVybiBjb25zb2xlLmxvZygndGhpcyB1c2VybmFtZSBhbHJlYWR5IGV4aXN0cycpXHJcblxyXG4gICAgJHJvb3RTY29wZS5pc0xvYWRpbmdIaWRkZW4gPSBmYWxzZVxyXG5cclxuICAgIEF1dGguJGNyZWF0ZVVzZXIoJHNjb3BlLm5ld1VzZXIpXHJcbiAgICAgIC50aGVuKGZ1bmN0aW9uKGF1dGhEYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIEF1dGguJGF1dGhXaXRoUGFzc3dvcmQoJHNjb3BlLm5ld1VzZXIpXHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKGZ1bmN0aW9uKGF1dGhEYXRhKSB7XHJcbiAgICAgICAgVXNlcnMuc2V0T25saW5lKGF1dGhEYXRhLnVpZClcclxuICAgICAgICB2YXIgcHJvZmlsZSA9IFVzZXJzLmdldFByb2ZpbGUoYXV0aERhdGEudWlkKVxyXG5cclxuICAgICAgICAkc2NvcGUudXNlcm5hbWVzWyRzY29wZS5uZXdVc2VyLnVzZXJuYW1lXSA9IGF1dGhEYXRhLnVpZFxyXG4gICAgICAgICRzY29wZS51c2VybmFtZXMuJHNhdmUoKVxyXG4gICAgICAgIHByb2ZpbGUudXNlcm5hbWUgPSAkc2NvcGUubmV3VXNlci51c2VybmFtZVxyXG4gICAgICAgIHByb2ZpbGUuYXZhdGFyID0gYXV0aERhdGEucGFzc3dvcmQucHJvZmlsZUltYWdlVVJMXHJcbiAgICAgICAgcHJvZmlsZS4kc2F2ZSgpXHJcbiAgICAgICAgVXNlcnMuYWxsLiRzYXZlKClcclxuICAgICAgICAkc3RhdGUuZ28oJ21lc3NhZ2VzLmNoYW5uZWwnKVxyXG4gICAgICB9KVxyXG4gIH1cclxufSIsbnVsbCwiYW5ndWxhci5tb2R1bGUoJ0ZsYW1lU2xhY2tBcHAnKVxyXG5cclxuICAuZmFjdG9yeSgnQXV0aCcsIGZ1bmN0aW9uKCRmaXJlYmFzZUF1dGgsIEZCKSB7XHJcbiAgICByZXR1cm4gJGZpcmViYXNlQXV0aChuZXcgRmlyZWJhc2UoRkIpKVxyXG4gIH0pXHJcblxyXG4gIC5mYWN0b3J5KCdVc2VycycsIGZ1bmN0aW9uKCRmaXJlYmFzZUFycmF5LCAkZmlyZWJhc2VPYmplY3QsIEZCKSB7XHJcbiAgICB2YXIgdXNlcnNSZWYgPSBuZXcgRmlyZWJhc2UoRkIgKyAndXNlcnMnKSxcclxuICAgICAgICBjb25uZWN0ZWRSZWYgPSBuZXcgRmlyZWJhc2UoRkIgKyAnLmluZm8vY29ubmVjdGVkJyksXHJcbiAgICAgICAgdXNlcnMgPSAkZmlyZWJhc2VBcnJheSh1c2Vyc1JlZilcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBnZXRQcm9maWxlOiBmdW5jdGlvbih1aWQpIHtcclxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHVzZXJzUmVmLmNoaWxkKHVpZCkpXHJcbiAgICAgIH0sXHJcbiAgICAgIHNldE9ubGluZTogZnVuY3Rpb24odWlkKSB7XHJcbiAgICAgICAgdmFyIGNvbm5lY3RlZCA9ICRmaXJlYmFzZU9iamVjdChjb25uZWN0ZWRSZWYpXHJcbiAgICAgICAgICAgIG9ubGluZSA9ICRmaXJlYmFzZUFycmF5KHVzZXJzUmVmLmNoaWxkKHVpZCArICcvb25saW5lJykpXHJcblxyXG4gICAgICAgIGNvbm5lY3RlZC4kd2F0Y2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBpZiAoY29ubmVjdGVkLiR2YWx1ZSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICBvbmxpbmUuJGFkZCh0cnVlKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIG9ubGluZS4kcmVmKCkub25EaXNjb25uZWN0KCkucmVtb3ZlKClcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICB1c2Vyc1JlZi5jaGlsZCh1aWQgKyAnL2xhc3RPbmxpbmUnKVxyXG4gICAgICAgICAgLm9uRGlzY29ubmVjdCgpLnNldChGaXJlYmFzZS5TZXJ2ZXJWYWx1ZS5USU1FU1RBTVApXHJcbiAgICAgIH0sXHJcbiAgICAgIHNldE9mZmxpbmU6IGZ1bmN0aW9uKHVpZCkge1xyXG4gICAgICAgIHVzZXJzUmVmLmNoaWxkKHVpZCArICcvb25saW5lJykucmVtb3ZlKClcclxuICAgICAgICB1c2Vyc1JlZi5jaGlsZCh1aWQgKyAnL2xhc3RPbmxpbmUnKS5zZXQoRmlyZWJhc2UuU2VydmVyVmFsdWUuVElNRVNUQU1QKVxyXG4gICAgICB9LFxyXG4gICAgICBpc0FkbWluOiBmdW5jdGlvbih1aWQpIHtcclxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KG5ldyBGaXJlYmFzZShGQikuY2hpbGQoJ2FkbWlucycpLmNoaWxkKHVpZCkpXHJcbiAgICAgIH0sXHJcbiAgICAgIGFsbDogdXNlcnNcclxuICAgIH1cclxuICB9KVxyXG5cclxuICAuZmFjdG9yeSgnVXNlcm5hbWVzJywgZnVuY3Rpb24oJGZpcmViYXNlT2JqZWN0LCBGQikge1xyXG4gICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChuZXcgRmlyZWJhc2UoRkIgKyAndXNlcm5hbWVzJykpXHJcbiAgfSlcclxuXHJcbiAgLmZhY3RvcnkoJ0NoYW5uZWxzJywgZnVuY3Rpb24oJGZpcmViYXNlT2JqZWN0LCBGQikge1xyXG4gICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChuZXcgRmlyZWJhc2UoRkIgKyAnY2hhbm5lbHMnKSlcclxuICB9KVxyXG5cclxuICAuZmFjdG9yeSgnTWVzc2FnZXMnLCBmdW5jdGlvbigkZmlyZWJhc2VBcnJheSwgRkIpIHtcclxuICAgIHZhciBtc2dSZWYgPSBuZXcgRmlyZWJhc2UoRkIgKyAnbWVzc2FnZXMnKVxyXG5cclxuICAgIHJldHVybiBmdW5jdGlvbihjaGFubmVsKSB7XHJcbiAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShtc2dSZWYuY2hpbGQoY2hhbm5lbCkpXHJcbiAgICB9XHJcbiAgfSlcclxuXHJcbiAgLmZhY3RvcnkoJ0RpcmVjdCcsIGZ1bmN0aW9uKCRmaXJlYmFzZUFycmF5LCAkZmlyZWJhc2VPYmplY3QsIEZCKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBtZXNzYWdlczogZnVuY3Rpb24odWlkMSwgdWlkMikge1xyXG4gICAgICAgIHZhciBwYXRoID0gdWlkMSA8IHVpZDIgPyB1aWQxICsgJy8nICsgdWlkMiA6IHVpZDIgKyAnLycgKyB1aWQxXHJcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KG5ldyBGaXJlYmFzZShGQikuY2hpbGQoJ2RpcmVjdCcpLmNoaWxkKHBhdGgpKVxyXG4gICAgICB9LFxyXG4gICAgICBub3RpZnk6IGZ1bmN0aW9uKGZyb20sIHRvKSB7XHJcbiAgICAgICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGQiArICdkaXJlY3ROb3RpZmljYXRpb24nKS5jaGlsZCh0bykuY2hpbGQoZnJvbSlcclxuICAgICAgICByZWYudHJhbnNhY3Rpb24oZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICByZXR1cm4gKHZhbCB8fCAwKSArIDFcclxuICAgICAgICB9KVxyXG4gICAgICB9LFxyXG4gICAgICBub3RpZmljYXRpb25zOiBmdW5jdGlvbih1aWQpIHtcclxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KG5ldyBGaXJlYmFzZShGQiArICdkaXJlY3ROb3RpZmljYXRpb24nKS5jaGlsZCh1aWQpKVxyXG4gICAgICB9LFxyXG4gICAgICByZW1vdmVOb3RpZmljYXRpb25zOiBmdW5jdGlvbih0bywgZnJvbSkge1xyXG4gICAgICAgIG5ldyBGaXJlYmFzZShGQiArICdkaXJlY3ROb3RpZmljYXRpb24nKS5jaGlsZCh0bykuY2hpbGQoZnJvbSkucmVtb3ZlKClcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pXHJcblxyXG4gIC5mYWN0b3J5KCdUaXRsZScsIGZ1bmN0aW9uKCRyb290U2NvcGUsIEZCKSB7XHJcbiAgICB2YXIgVGl0bGUgPSB7XHJcbiAgICAgIHNldDogZnVuY3Rpb24oY2hhbm5lbCkge1xyXG4gICAgICAgICRyb290U2NvcGUudGl0bGUgPSBjaGFubmVsICsgJyB8IEZsYW1lIFNsYWNrJ1xyXG4gICAgICB9LFxyXG4gICAgICBhZGQ6IGZ1bmN0aW9uKHMpIHtcclxuICAgICAgICBpZiAoIX4kcm9vdFNjb3BlLnRpdGxlLmluZGV4T2YocykpXHJcbiAgICAgICAgICAkcm9vdFNjb3BlLnRpdGxlID0gcyArICRyb290U2NvcGUudGl0bGVcclxuICAgICAgfSxcclxuICAgICAgcmVtb3ZlOiBmdW5jdGlvbihzKSB7XHJcbiAgICAgICAgaWYgKCFzKVxyXG4gICAgICAgICAgJHJvb3RTY29wZS50aXRsZSA9ICgkcm9vdFNjb3BlLnRpdGxlfHwnJykucmVwbGFjZSgvW1xcIVxcKl0gL2csICcnKVxyXG4gICAgICAgIGVsc2UgaWYgKH4kcm9vdFNjb3BlLnRpdGxlLmluZGV4T2YocykpXHJcbiAgICAgICAgICAkcm9vdFNjb3BlLnRpdGxlID0gKCRyb290U2NvcGUudGl0bGV8fCcnKS5yZXBsYWNlKHMsICcnKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIFRpdGxlXHJcbiAgfSkiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
