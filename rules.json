{
  "rules": {
    ".read": true,
    "users": {
      "$uid": {
        ".write": "auth != null && $uid == auth.uid",
        "id": {
          ".validate": "newData.val() == $uid"
        },
        "username": {
          ".validate": "newData.isString() && newData.val().length > 2 && newData.val().length < 10"
        },
        "online": {
          "$connectionId": {
            ".validate": "newData.isBoolean()"
          }
        }
      }
    },
    "channels": {
      ".write": "auth != null && root.child('admins/' + auth.uid).exists()",
      ".validate": "newData.isString() && newData.val().length > 2 && newData.val().length < 10"
    },
    "messages": {
      "$channel": {
        ".write": "auth != null && root.child('admins/' + auth.uid).exists()",
        "$messageId": {
          ".write": "auth != null",
          ".validate": "newData.hasChildren(['author', 'channel', 'text', 'timestamp'])",
          "channel": {
            ".validate": "root.child('channels/'+newData.val()).exists()"
          },
          "text": {
            ".validate": "newData.val().length > 0"
          },
          "timestamp": {
            ".validate": "newData.val() <= now"
          }          
        }
      }
    }
  }
}